<script>
  function showPinyin(el) {
    let existing = el.querySelector('.pinyin');
    if (existing) {
      existing.style.display = 'block';
    } else {
      let pinyin = document.createElement('div');
      pinyin.className = 'pinyin';
      pinyin.textContent = el.getAttribute('data-pinyin');
      el.appendChild(pinyin);
      pinyin.style.display = 'block';
    }
    setTimeout(() => {
      const pinyinDiv = el.querySelector('.pinyin');
      if (pinyinDiv) {
        pinyinDiv.style.display = 'none';
      }
    }, 3000);
  }

  function convert() {
    const input = document.getElementById('input').value.trim();
    const lines = input.split('\n');
    const output = document.getElementById('output');
    output.innerHTML = '';

    for (let i = 0; i < lines.length; i += 2) {
      const chinese = lines[i] || '';
      const pinyin = lines[i + 1] || '';

      let html = '<p>';
      html += `<span class="sentence" onclick="showPinyin(this)" data-pinyin="${pinyin}">${chinese}</span>`;
      html += '</p>';

      output.innerHTML += html;
    }

    // Lưu vào localStorage
    localStorage.setItem('inputText', document.getElementById('input').value);
    localStorage.setItem('outputHTML', output.innerHTML);
  }

  function clearContent() {
    document.getElementById('input').value = '';
    document.getElementById('output').innerHTML = '';
    localStorage.removeItem('inputText');
    localStorage.removeItem('outputHTML');
  }

  // Khôi phục dữ liệu khi tải lại trang
  window.onload = function() {
    const savedInput = localStorage.getItem('inputText');
    const savedOutput = localStorage.getItem('outputHTML');
    if (savedInput) {
      document.getElementById('input').value = savedInput;
    }
    if (savedOutput) {
      document.getElementById('output').innerHTML = savedOutput;
    }
  }
</script>
